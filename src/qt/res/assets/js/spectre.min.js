function invalid(e,t){return!0===t?e.css("background","").css("color",""):e.css("background","#155b9a").css("color","white"),1==t}function updateValue(e){function t(t){var s=$(".newval");0!==s.length&&e.html(a.replace(n,s.val().trim()))}var a=e.html(),n=void 0!==e.parent("td").data("label")?e.parent("td").data("label"):void 0!==e.parent("td").data("value")?e.parent("td").data("value"):void 0!==e.data("label")?e.data("label"):void 0!==e.data("value")?e.data("value"):e.text(),s=e.parents(".selected").find(".address"),o=e.parents(".selected").find(".addresstype");s=s.data("value")?s.data("value"):s.text(),1===o.length&&(o=o.data("value")?o.data("value"):o.text()),e.html('<input class="newval" type="text" onchange="bridge.updateAddressLabel(\''+s+'\', this.value);" value="'+n+'" size=60 />'),$(".newval").focus().on("contextmenu",function(e){e.stopPropagation()}).keyup(function(e){13==e.keyCode&&t()}),$(document).one("click",t)}var connectSignalsAttempts=0;function connectSignals(){"undefined"!=typeof bridge&&"undefined"!=typeof optionsModel&&"undefined"!=typeof walletModel?(bridge.emitPaste.connect(pasteValue),bridge.emitTransactions.connect(appendTransactions),bridge.emitAddresses.connect(appendAddresses),bridge.emitCoinControlUpdate.connect(updateCoinControlInfo),bridge.triggerElement.connect(triggerElement),bridge.emitReceipient.connect(addRecipientDetail),bridge.networkAlert.connect(networkAlert),bridge.getAddressLabelResult.connect(getAddressLabelResult),bridge.newAddressResult.connect(newAddressResult),bridge.lastAddressErrorResult.connect(lastAddressErrorResult),bridge.getAddressLabelForSelectorResult.connect(getAddressLabelForSelectorResult),blockExplorerPage.connectSignals(),walletManagementPage.connectSignals(),optionsPage.connectSignals(),chainDataPage.connectSignals(),bridge.validateAddressResult.connect(validateAddressResult),bridge.addRecipientResult.connect(addRecipientResult),bridge.sendCoinsResult.connect(sendCoinsResult),bridge.transactionDetailsResult.connect(transactionDetailsResult),optionsModel.displayUnitChanged.connect(unit_setType),optionsModel.reserveBalanceChanged.connect(updateReserved),optionsModel.rowsPerPageChanged.connect(updateRowsPerPage),optionsModel.visibleTransactionsChanged.connect(visibleTransactions),walletModel.encryptionStatusChanged.connect(encryptionStatusChanged),walletModel.balanceChanged.connect(updateBalance),overviewPage.clientInfo(),optionsPage.update(),chainDataPage.updateAnonOutputs(),translateStrings(),bridge.jsReady()):(connectSignalsAttempts+=1)<50?(console.log("retrying connecting signals in 200ms"),setTimeout(connectSignals,200)):(console.log("giving up on connecting signals."),console.log("bridge: "+bridge),console.log("optionsModel: "+optionsModel),console.log("walletModel: "+walletModel))}function transactionDetailsResult(e){$("#transaction-info").html(e)}var numOfRecipients=void 0;function validateAddressResult(e){}function sendCoinsResult(e){console.log("sendCoinsResult"),console.log(e),sendPage.update(e,void 0)}function addRecipientResult(e){sendPage.update(void 0,e)}function encryptionStatusChanged(e){overviewPage.encryptionStatusChanged(e)}function unit_setType(e){unit.setType(e)}function updateCoinControlInfo(e,t,a,n,s,o,l,i){sendPage.updateCoinControlInfo(e,t,a,n,s,o,l,i)}function addRecipientDetail(e,t,a,n){sendPage.addRecipientDetail(e,t,a,n)}function updateReserved(e){overviewPage.updateReserved(e)}function updateBalance(e,t,a,n,s,o,l,i){overviewPage.updateBalance(e,t,a,n,s,o,l,i)}function triggerElement(e,t){$(e).trigger(t)}function updateRowsPerPage(e){$(".footable").each(function(){var t=$(this);t.hasClass("footable-lookup")||(t.data().pageSize=e,t.trigger("footable_initialize"))})}function pasteValue(e){$(pasteTo).val(e)}function paste(e){pasteTo=e,bridge.paste(),0!=pasteTo.indexOf("#pay_to")&&"#change_address"!=pasteTo||base58.check(pasteTo)}function copy(e,t){var a="";try{a=$(e).text()}catch(e){}null!=a&&null==t||(a="copy"==t?e:$(e).attr(t)),bridge.copy(a)}function networkAlert(e){$("#network-alert span").text(e).toggle(""!==e)}function openContextMenu(e){-1===contextMenus.indexOf(e)&&contextMenus.push(e),void 0!==e.isOpen&&1===e.isOpen&&(e.isOpen=0,e.close&&e.close());for(var t=0;t<contextMenus.length;++t)contextMenus[t].isOpen=contextMenus[t]==e?1:0}function receivePageInit(){var e=[{name:"Copy&nbsp;Address",fun:function(){copy("#receive .footable .selected .address")}},{name:"Copy&nbsp;Label",fun:function(){copy("#receive .footable .selected .label2")}},{name:"Copy&nbsp;Public&nbsp;Key",fun:function(){copy("#receive .footable .selected .pubkey")}},{name:"Edit",fun:function(){$("#receive .footable .selected .label2.editable").dblclick()}}];$("#receive .footable tbody").on("contextmenu",function(e){$(e.target).closest("tr").click()}).contextMenu(e,{triggerOn:"contextmenu",sizeStyle:"content"}),$("#filter-address").on("input",function(){var e=$("#receive-table");""===$("#filter-address").val()&&e.data("footable-filter").clearFilter(),$("#receive-filter").val($("#filter-address").val()+" "+$("#filter-addresstype").val()),e.trigger("footable_filter",{filter:$("#receive-filter").val()})}),$("#filter-addresstype").change(function(){var e=$("#receive-table");""===$("#filter-addresstype").val()&&e.data("footable-filter").clearFilter(),$("#receive-filter").val($("#filter-address").val()+" "+$("#filter-addresstype").val()),e.trigger("footable_filter",{filter:$("#receive-filter").val()})})}function clearRecvAddress(){$("#new-address-label").val(""),$("#new-addresstype").val(1)}function addAddress(){console.log("addAddress");var e=$("#new-addresstype").val(),t=$("#new-address-label").val();bridge.newAddress(t,e,"",!1)}function clearSendAddress(){$("#new-send-label").val(""),$("#new-send-address").val(""),$("#new-send-address-error").text(""),$("#new-send-address").removeClass("inputError")}function getAddressLabelForSelectorResult(e,t,a){e||(e=a),$(t).val(e).text(e).change()}function addSendAddress(){var e=$("#new-send-address").val();bridge.getAddressLabelAsync(e)}function getAddressLabelResult(e){console.log("getAddressLabelResult");var t,a,n;if(a=$("#new-send-label").val(),t=$("#new-send-address").val(),""!==(n=e))return $("#new-send-address-error").text('Error: address already in addressbook under "'+n+'"'),void $("#new-send-address").addClass("inputError");bridge.newAddressAsync(a,0,t,!0)}function newAddressResult(e){data=e,""===data?bridge.lastAddressError():$("#add-address-modal").modal("hide")}function lastAddressErrorResult(e){var t=e;$("#new-send-address-error").text("Error: "+t),$("#new-send-address").addClass("inputError")}function addressBookInit(){var e=[{name:"Copy&nbsp;Address",fun:function(){copy("#addressbook .footable .selected .address")}},{name:"Copy&nbsp;Public&nbsp;Key",fun:function(){copy("#addressbook .footable .selected .pubkey")}},{name:"Copy&nbsp;Label",fun:function(){copy("#addressbook .footable .selected .label2")}},{name:"Edit",fun:function(){$("#addressbook .footable .selected .label2.editable").dblclick()}},{name:"Delete",fun:function(){var e=$("#addressbook .footable .selected .address");bridge.deleteAddress(e.text()),e.closest("tr").remove()}}];$("#addressbook .footable tbody").on("contextmenu",function(e){$(e.target).closest("tr").click()}).contextMenu(e,{triggerOn:"contextmenu",sizeStyle:"content"}),$("#filter-addressbook").on("input",function(){var e=$("#addressbook-table");""==$("#filter-addressbook").val()&&e.data("footable-filter").clearFilter(),$("#addressbook-filter").val($("#filter-addressbook").val()+" "+$("#filter-addressbooktype").val()),e.trigger("footable_filter",{filter:$("#addressbook-filter").val()})}),$("#filter-addressbooktype").change(function(){var e=$("#addressbook-table");""==$("#filter-addresstype").val()&&e.data("footable-filter").clearFilter(),$("#addressbook-filter").val($("#filter-addressbook").val()+" "+$("#filter-addressbooktype").val()),e.trigger("footable_filter",{filter:$("#addressbook-filter").val()})})}function appendAddresses(e){if(console.log("appending an address: "+e),"string"==typeof e){if("[]"==e)return;e=JSON.parse(e.replace(/,\]$/,"]"))}e.forEach(function(e){var t=$("#"+e.address),a="S"==e.type?"#addressbook":"#receive";"R"==e.type&&sendPage.initSendBalance(e)&&e.address.length<75&&(0==t.length?$("#message-from-address").append("<option title='"+e.address+"' value='"+e.address+"'>"+e.label+"</option>"):$("#message-from-address option[value="+e.address+"]").text(e.label));e.type,e.pubkey;0==t.length?($(a+" .footable tbody").append("<tr id='"+e.address+"' lbl='"+e.label+"'>                 <td style='padding-left:18px;' class='label2 editable' data-value='"+e.label_value+"'>"+e.label+"</td>                 <td class='address'>"+e.address+"</td>                 <td class='pubkey'>"+e.pubkey+"</td>                 <td class='addresstype'>"+(4==e.at?"Group":3==e.at?"BIP32":2==e.at?"Stealth":"Normal")+"</td></tr>"),$("#"+e.address).selection("tr").find(".editable").on("dblclick",function(e){e.stopPropagation(),updateValue($(this))}).attr("data-title","Double click to edit").tooltip()):($("#"+e.address+" .label2").data("value",e.label_value).text(e.label),$("#"+e.address+" .pubkey").text(e.pubkey))}),$("#addressbook .footable,#receive .footable").trigger("footable_setup_paging")}function addressLookup(e,t,a){function n(){$("#address-lookup-filter").val($("#address-lookup-address-filter").val()+" "+$("#address-lookup-address-type").val()),o.trigger("footable_filter",{filter:$("#address-lookup-filter").val()})}var s=$((t?"#receive":"#addressbook")+" table.footable > tbody").html(),o=$("#address-lookup-table");o.children("tbody").html(s),o.trigger("footable_initialize"),o.data("footable-filter").clearFilter(),$("#address-lookup-table > tbody tr").selection().on("dblclick",function(){var t=e.split(",");$("#"+t[0]).val($(this).attr("id").trim()).change(),void 0!==t[1]&&$("#"+t[1]).val($(this).attr("lbl").trim()).text($(this).attr("lbl").trim()).change(),$("#address-lookup-modal").modal("hide")}),$("#address-lookup-address-filter").on("input",function(){""==$("#lookup-address-filter").val()&&o.data("footable-filter").clearFilter(),n()}),$("#address-lookup-address-type").change(function(){""==$("#address-lookup-address-type").val()&&o.data("footable-filter").clearFilter(),n()}),a&&($("#address-lookup-address-type").val(a),n())}function transactionPageInit(){var e=[{name:"Copy&nbsp;Amount",fun:function(){copy("#transactions .footable .selected .amount","data-value")}},{name:"Copy&nbsp;transaction&nbsp;ID",fun:function(){var e=$("#transactions .footable .selected").attr("id");copy(e.substring(0,e.length-4),"copy")}},{name:"Edit&nbsp;label",fun:function(){$("#transactions .footable .selected .editable").dblclick()}},{name:"Show&nbsp;transaction&nbsp;details",fun:function(){$("#transactions .footable .selected").dblclick()}}];$("#transactions .footable tbody").on("contextmenu",function(e){$(e.target).closest("tr").click()}).contextMenu(e,{triggerOn:"contextmenu",sizeStyle:"content"}),$("#transactions .footable").on("footable_paging",function(e){var t=filteredTransactions.slice(e.page*e.size);t=t.slice(0,e.size);var a=$("#transactions .footable tbody");a.html(""),delete e.ft.pageInfo.pages[e.page],e.ft.pageInfo.pages[e.page]=t.map(function(e){var t=Array.isArray(e)?e[0].id:e.id;return e.html=formatTransaction(e),a.append(e.html),$("#"+t)[0]}),e.result=!0,bindTransactionTableEvents()}).on("footable_create_pages",function(e){var t=$("#transactions .footable");$(t.data("filter")).val()||(filteredTransactions=Transactions);var a=t.data("sorted"),n=1==t.find("th.footable-sorted").length,s="numeric";switch(a){case 1:a="d";break;case 2:a="t_l",s="alpha";break;case 3:a="ad",s="alpha";break;case 4:a="n",s="alpha";break;case 5:a="am";break;default:a="c"}s=e.ft.options.sorters[s],filteredTransactions.sort(function(e,t){var o=Array.isArray(e)?e[0]:e,l=Array.isArray(t)?t[0]:t;return n?s(o[a],l[a]):s(l[a],o[a])}),delete e.ft.pageInfo.pages,e.ft.pageInfo.pages=[];var o=Math.ceil(filteredTransactions.length/e.ft.pageInfo.pageSize),l=[];if(o>0){for(var i=0;i<e.ft.pageInfo.pageSize;i++)l.push([]);for(i=0;i<o;i++)e.ft.pageInfo.pages.push(l)}}).on("footable_filtering",function(e){e.clear||(filteredTransactions=[],Transactions.forEach(function(t){if(Array.isArray(t)){var a=t.filter(function(t){return filterTransaction(t,e.filter)});1===a.length?filteredTransactions.push(a[0]):a.length>0&&filteredTransactions.push(a)}else filterTransaction(t,e.filter)&&filteredTransactions.push(t)}))})}function filterTransaction(e,t){var a;for(a in e)if(-1!==e[a].toString().toLowerCase().indexOf(t.toLowerCase()))return!0;return!1}function formatTransaction(e){if(Array.isArray(e)){var t=e[0].tt;e.length>1&&e[0].tt!==e[e.length-1].tt&&(t="Tx.No. 1:\n"+t,t+="\n-\nTx.No. "+e.length+":\n"+e[e.length-1].tt);var a=0,n="",s=new Set;e.forEach(function(e){s.add(e.ad_d.trim()),e.n&&(n&&(n+="; "),n+=e.n.trim()),a+=e.am});var o="";return s.forEach(function(e){o&&(o+="; "),o+=e}),"<tr id='"+(l=e[0]).id+"'"+(1===e.length?" data-title='"+l.tt+"'":"")+"><td class='trans-status' data-value='"+l.c+"'"+(e.length>1?" data-title='"+t+"'":"")+"><center><i class='fa fa-lg "+l.s+"'></center></td><td data-value='"+l.d+"'"+(e.length>1?" data-title='"+e[0].d_s+" - "+e[e.length-1].d_s+"'":"")+">"+l.d_s+"</td><td class='amount' style='color:"+l.am_c+";' data-value='"+unit.format(a)+"'>"+unit.format(a)+"</td><td class='trans_type'"+(e.length>1?" data-title='"+t+"'":"")+"><img height='15' width='15' src='qrc:///qrc:///assets/icons/tx_"+l.t+".png' /> "+l.t_l+" <b>(x"+e.length+")</b></td><td class='address' style='color:"+l.a_c+";' data-value='"+o+"' data-label='"+o+"' data-title='"+o+"' ><span>"+o+"</span></td><td class='trans-nar' data-title='"+n+"'>"+n+"</td></tr>"}var l;return"<tr id='"+(l=e).id+"' data-title='"+l.tt+"'><td class='trans-status' data-value='"+l.c+"'><center><i class='fa fa-lg "+l.s+"'></center></td><td data-value='"+l.d+"'>"+l.d_s+"</td><td class='amount' style='color:"+l.am_c+";' data-value='"+l.am_d+"'>"+l.am_d+"</td><td class='trans_type'><img height='15' width='15' src='qrc:///qrc:///assets/icons/tx_"+l.t+".png' /> "+l.t_l+"</td><td class='address' style='color:"+l.a_c+";' data-value='"+l.ad+"' data-label='"+l.ad_l+"'><span "+(l.ad?"class='editable'":"")+">"+l.ad_d+"</span></td><td class='trans-nar'>"+l.n+"</td></tr>"}function visibleTransactions(e){"*"!==e[0]&&(RawTransactions=RawTransactions.filter(function(e){return this.some(function(e){return e==this},e.t_l)},e),prepareTransactions())}function bindTransactionTableEvents(){$("#transactions .footable tbody td[data-title]").tooltip(),$("#transactions .footable tbody tr[data-title]").tooltip(),$("#transactions .footable tbody tr").on("click",function(){$(this).addClass("selected").siblings("tr").removeClass("selected")}).on("dblclick",function(e){$(this).attr("href","#transaction-info-modal"),$("#transaction-info-modal").appendTo("body").modal("show"),bridge.transactionDetails($(this).attr("id")),$(this).click(),$(this).off("click"),$(this).on("click",function(){$(this).addClass("selected").siblings("tr").removeClass("selected")})}).find(".editable").on("dblclick",function(e){e.stopPropagation(),e.preventDefault(),updateValue($(this))}).attr("data-title","Double click to edit").tooltip()}function appendTransactions(e,t){if(console.log(e),"string"==typeof e){if("[]"==e&&!t)return;e=JSON.parse(e.replace(/,\]$/,"]"))}e.sort(function(e,t){return e.d=parseInt(e.d),t.d=parseInt(t.d),t.d-e.d}),t?RawTransactions=e:1==e.length&&-1==e[0].id||(RawTransactions=RawTransactions.filter(function(e){return 0==this.some(function(e){return e.id==this.id},e)},e).concat(e)),overviewPage.recent(e.slice(0,7)),prepareTransactions()}function prepareTransactions(){var e=$("select[id=optGroupTxType]").val(),t=$("select[id=optGroupTxTime]").val();if("0"===t)Transactions=RawTransactions;else{var a={};Transactions=[],RawTransactions.forEach(function(n){if("0"===e&&(n.t_i<1||n.t_i>6))Transactions.push(n);else{var s=new Date(1e3*n.d),o=(9!==n.s_i?n.t_i:3===n.t_i||5===n.t_i?1:4===n.t_i||6===n.t_i?2:n.t_i)+"-"+n.s_i;switch(t){case"1":o=s.getDate()+"-"+o;case"2":o=s.getMonth()+"-"+o;case"3":o=s.getFullYear()+"-"+o}var l=a[o];l?l.push(n):(a[o]=[n],Transactions.push(a[o]))}})}$("#transactions .footable").trigger("footable_redraw")}function getIconTitle(e){return"unverified"==e?"fa fa-cross ":"verified"==e?"fa fa-check ":"contributor"==e?"fa fa-cog ":"spectreteam"==e?"fa fa-code ":""}function signMessage(){var e,t,a;$("#sign-signature").val("");e=$("#sign-address").val().trim(),t=$("#sign-message").val().trim();var n=bridge.signMessage(e,t);return a=n.error_msg,n.signed_signature,""!==a?($("#sign-result").removeClass("green"),$("#sign-result").addClass("red"),$("#sign-result").html(a),!1):($("#sign-signature").val(n.signed_signature),$("#sign-result").removeClass("red"),$("#sign-result").addClass("green"),void $("#sign-result").html("Message signed successfully"))}function verifyMessage(){var e,t,a,n;return e=$("#verify-address").val().trim(),t=$("#verify-message").val().trim(),n=$("#verify-signature").val().trim(),""!==(a=bridge.verifyMessage(e,t,n).error_msg)?($("#verify-result").removeClass("green"),$("#verify-result").addClass("red"),$("#verify-result").html(a),!1):($("#verify-result").removeClass("red"),$("#verify-result").addClass("green"),void $("#verify-result").html("Message verified successfully"))}function iscrollReload(e){messagesScroller.refresh(),!0===e&&messagesScroller.scrollTo(0,messagesScroller.maxScrollY,0)}function editorCommand(e,t){var a,n,s,o=$("#message-text")[0];s=o.scrollTop,o.focus(),void 0!==o.selectionStart?(a=o.selectionStart,n=o.selectionEnd,e.length,t&&(e+=o.value.substring(a,n)+t),o.value=o.value.substring(0,a)+e+o.value.substring(n,o.value.length),o.selectionStart=a+e.length-(t?t.length:0),o.selectionEnd=o.selectionStart):o.value+=e+t,o.scrollTop=s,o.focus()}function setupWizard(e){var t=$("#"+e+" > div");backbtnjs='$("#key-options").show(); $("#wizards").hide();',fwdbtnjs='gotoWizard("new-key-wizard", 1);',$("#"+e).prepend("<div id='backWiz' style='display:none;' class='btn btn-default btn-cons wizardback' onclick='"+backbtnjs+"' >Back</div>"),$("#"+e).prepend("<div id='fwdWiz'  style='display:none;' class='btn btn-default btn-cons wizardfwd'  onclick='"+fwdbtnjs+"' >Next Step</div>"),t.each(function(e){$(this).addClass("step"+e),$(this).hide(),$("#backWiz").hide()})}function gotoWizard(vid,node,dataAndEvents){var collection=$("#wizards > div");if(validateJS=$("#"+vid+" .step"+(node-1)).attr("validateJS"),dataAndEvents&&void 0!==validateJS){var jsonObj=eval(validateJS);if(!jsonObj)return!1}collection.each(function(e){$(this).hide()});var $allModules=$("#"+vid+" > div[class^=step]"),current=node;null==current&&(current=0),0==current?($("#"+vid+" #backWiz").attr("onclick",'$(".wizardback").hide(); $("#wizards").show();'),$("#"+vid+" #fwdWiz").attr("onclick",'$(".wizardback").hide(); gotoWizard("'+vid+'", 1, true);'),$("#backWiz").hide()):($("#"+vid+" #backWiz").attr("onclick",'gotoWizard("'+vid+'", '+(current-1)+" , false);"),$("#"+vid+" #fwdWiz").attr("onclick",'gotoWizard("'+vid+'", '+(current+1)+" , true);")),endWiz=$("#"+vid+" .step"+node).attr("endWiz"),void 0!==endWiz&&""!==endWiz&&$("#"+vid+" #fwdWiz").attr("onclick",endWiz),$allModules.each(function(e){$(this).hide()}),$("#"+vid).show(),stepJS=$("#"+vid+" .step"+current).attr("stepJS"),dataAndEvents&&void 0!==stepJS&&eval(stepJS),$("#"+vid+" .step"+current).fadeIn(0)}function dumpStrings(){function e(e){return'QT_TRANSLATE_NOOP("SpectreBridge", "'+e+'"),\n'}var t="";$(".translate").each(function(a){var n=e($(this).text().trim());-1==t.indexOf(n)&&(t+=n)}),$("[data-title]").each(function(a){var n=e($(this).attr("data-title").trim());-1==t.indexOf(n)&&(t+=n)}),console.log(t)}function translateStrings(){}var breakpoint=906,base58={base58Chars:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",check:function(e){for(var t=$(e),a=t.val(),n=0,s=a.length;n<s;++n)if(-1==base58.base58Chars.indexOf(a[n]))return t.css("background","#1c5ce5").css("color","white"),!1;return t.css("background","").css("color",""),!0}},pasteTo="",unit={type:0,name:"XSPEC",display:"XSPEC",nameSpectre:"SPECTRE",displaySpectre:"SPECTRE",setType:function(e){switch(this.type=null==e?0:e,e){case 1:this.name="mXSPEC",this.display="mXSPEC",this.nameSpectre="mSPECTRE",this.displaySpectre="mSPECTRE";break;case 2:this.name="uXSPEC",this.display="&micro;XSPEC",this.nameSpectre="uSPECTRE",this.displaySpectre="&micro;SPECTRE";break;case 3:this.name="sXSPEC",this.display="xSpectoshi",this.nameSpectre="sSPECTRE",this.displaySpectre="Spectoshi";break;default:this.name="XSPEC",this.display="XSPEC",this.nameSpectre="SPECTRE",this.displaySpectre="SPECTRE"}$("td.unit,span.unit,div.unit").html(this.display),$("select.unit").val(e).trigger("change"),$("input.unit").val(this.name),$("td.unitSpectre,span.unitSpectre,div.unitSpectre").html(this.displaySpectre),$("select.unitSpectre").val(e).trigger("change"),$("input.unitSpectre").val(this.nameSpectre),overviewPage.updateBalance()},format:function(e,t){var a=$.isNumeric(e)?null:$(e);switch(t=null==t?this.type:parseInt(t),e=parseInt(null==a?e:null==a.data("value")?a.val():a.data("value")),t){case 1:e/=1e5;break;case 2:e/=100;break;case 3:break;default:e/=1e8}return e=e.toFixed(this.mask(t)),null==a?e:void a.val(e)},parse:function(e,t){var a=$.isNumeric(e)?null:$(e);t=null==t?this.type:parseInt(t),fp=null==a?e:a.val(),null==fp||fp.length<1?fp=["0","0"]:"."==fp[0]?fp=["0",fp.slice(1)]:fp=fp.split("."),e=parseInt(fp[0]);var n=this.mask(t);if(n>0&&(e*=Math.pow(10,n)),n>0&&fp.length>1){for(var s=fp[1].split("");s.length>1&&"0"==s[s.length-1];)s.pop();var o=parseInt(s.join(""));o>0&&((n-=s.length)>0&&(o*=Math.pow(10,n)),e+=o)}return null==a?e:(a.data("value",e),void this.format(a,t))},mask:function(e){switch(e=null==e?this.type:parseInt(e)){case 1:return 5;case 2:return 2;case 3:return 0;default:return 8}},keydown:function(e){var t=e.which,a=$(e.target).siblings(".unit").val();if(190==t||110==t)return-1===this.value.toString().indexOf(".")&&0!=unit.mask(a)||e.preventDefault(),!0;if(e.shiftKey||!(t>=96&&t<=105||t>=48&&t<=57))8!=t&&9!=t&&17!=t&&46!=t&&45!=t&&(t>=35&&t<=40||(!e.ctrlKey||65!=t&&67!=t&&86!=t&&88!=t)&&e.preventDefault());else{var n=this.selectionStart,s=this.value.indexOf(".");if("Range"!==document.getSelection().type&&n>s&&-1!==this.value.indexOf(".")&&this.value.length-1-s>=unit.mask(a)){if("0"==this.value[this.value.length-1]&&n<this.value.length)return this.value=this.value.slice(0,-1),this.selectionStart=n,void(this.selectionEnd=n);e.preventDefault()}}},paste:function(e){var t=e.originalEvent.clipboardData.getData("text/plain");(!$.isNumeric(t)||-1!==this.value.indexOf(".")&&"Range"!==document.getSelection().type)&&e.preventDefault()}},contextMenus=[],overviewPage={init:function(){this.balance=$(".balance"),this.spectreBal=$(".spectre_balance"),this.reserved=$("#reserved"),this.reservedSpectre=$("#reserved_spectre"),this.stake=$("#stake"),this.spectreStake=$("#spectre_stake"),this.unconfirmed=$("#unconfirmed"),this.spectreUnconfirmed=$("#spectre_unconfirmed"),this.immature=$("#immature"),this.spectreImmature=$("#spectre_immature"),this.total=$("#total")},updateBalance:function(e,t,a,n,s,o,l,i){null==e?(e=this.balance.data("orig"),t=this.spectreBal.data("orig"),a=this.stake.data("orig"),n=this.spectreStake.data("orig"),s=this.unconfirmed.data("orig"),o=this.spectreUnconfirmed.data("orig"),l=this.immature.data("orig"),i=this.spectreImmature.data("orig")):(this.balance.data("orig",e),this.spectreBal.data("orig",t),this.stake.data("orig",a),this.spectreStake.data("orig",n),this.unconfirmed.data("orig",s),this.spectreUnconfirmed.data("orig",s),this.immature.data("orig",l),this.spectreImmature.data("orig",i)),this.formatValue("balance","spectreBal",e,t,!0),this.formatValue("stake","spectreStake",a,n),this.formatValue("unconfirmed","spectreUnconfirmed",s,o),this.formatValue("immature","spectreImmature",l,i),this.formatTotalValue(e+t+a+n+s+o+l+i)},updateReserved:function(e){this.formatValue("reserved","reservedSpectre",e,e)},formatTotalValue:function(e){var t=["0","0"];void 0===e||isNaN(e)||(t=unit.format(e).split(".")),$("#total-big > span:first-child").text(t[0]),3==unit.type?($("#total-big .light-red").toggle(!1),$("#total-big .cents").toggle(!1)):($("#total-big .cents").text(t[1]),$("#total-big .light-red").toggle(!0),$("#total-big .cents").toggle(!0))},formatValue:function(e,t,a,n,s){var o=this[e],l=this[t];0!==a||s?o.text(unit.format(a)):o.html(""),0!==n||s?l.text(unit.format(n)):l.html(""),s||0!==a||0!==n?o.parent("tr").show():o.parent("tr").hide()},recent:function(e){for(var t=0;t<e.length;t++)overviewPage.updateTransaction(e[t]);$("#recenttxns [data-title]").tooltip()},updateTransaction:function(e){var t,a="<tr><td class='text-left' width='30%' style='border-top: 1px solid rgba(230, 230, 230, 0.7);border-bottom: none;'><center><label style='margin-top:6px;' class='label label-important inline fs-12'>"+(8===(t=e).s_i||9===t.s_i?"Orphan":"input"==t.t?"Received":"output"==t.t?"Sent":"inout"==t.t?"In-Out":"staked"==t.t?"Stake":"donated"==t.t?"Donated":"contributed"==t.t?"Contributed":"other"==t.t?"Other":t.t)+"</label></center></td><td class='text-left' style='border-top: 1px solid rgba(230, 230, 230, 0.7);border-bottom: none;'><center><a id='"+t.id.substring(t.id.length-20)+"' data-title='"+t.tt+"' href='#' onclick='$(\"#navitems [href=#transactions]\").click();$(\"#"+t.id+"\").click();'> "+unit.format(t.am)+" "+("SPECTRE"===t.am_curr?unit.displaySpectre:unit.display)+" </a></center></td><td width='30%' style='border-top: 1px solid rgba(230, 230, 230, 0.7);border-bottom: none;'><span class='overview_date' data-value='"+t.d+"'><center>"+t.d_s+"</center></span></td></tr>",n=e.id.substring(e.id.length-20),s=$("#"+n).attr("data-title",e.tt).closest("tr");if(0==s.length){for(var o=$("#recenttxns tr"),l=!1,i=0;i<o.length;i++){var r=$(o[i]);if(parseInt(e.d)>parseInt(r.find(".overview_date").data("value"))){r.before(a),l=!0;break}}for(l||$("#recenttxns").append(a),o=$("#recenttxns tr");o.length>8;)$("#recenttxns tr:last").remove(),o=$("#recenttxns tr")}else s.replaceWith(a)},clientInfo:function(){$("#version").text(bridge.info.build.replace(/\-[\w\d]*$/,"")),$("#clientinfo").attr("data-title","Build Desc: "+bridge.info.build+"\nBuild Date: "+bridge.info.date).tooltip()},encryptionStatusChanged:function(e){e}},optionsPage={init:function(){},connectSignals:function(){bridge.getOptionResult.connect(this.getOptionResult)},getOptionResult:function(e){function t(e){var t=(e=$(this)).prop("checked"),a=e.data("linked");if(a){a=a.split(" ");for(var n=0;n<a.length;n++){var s=$("#"+a[n]+",[for="+a[n]+"]").attr("disabled",!t);t?s.removeClass("disabled"):s.addClass("disabled")}}}var a,n=e;for(a in console.log("result"),console.log(e),$("#options-ok,#options-apply").addClass("disabled"),n){var s=$("#opt"+a),o=n[a],l=n["opt"+a];if(0!=s.length){var i;if(l)for(i in s.html(""),l)if("string"==typeof i&&$.isArray(l[i])&&!$.isNumeric(i)){s.append("<optgroup label='"+i[0].toUpperCase()+i.slice(1)+"'>");for(var r=0;r<l[i].length;r++)s.append("<option>"+l[i][r]+"</option>")}else s.append("<option"+($.isNumeric(i)?"":" value='"+i+"'")+">"+l[i]+"</option>");s.is(":checkbox")?(s.prop("checked",!0===o||"true"===o),s.off("change"),s.on("change",t),s.change()):s.is("select[multiple]")&&"*"===o?s.find("option").attr("selected",!0):s.val(o),s.one("change",function(){$("#options-ok,#options-apply").removeClass("disabled")})}else-1==a.indexOf("opt")&&console.log("Option element not available for %s",a)}},update:function(){bridge.getOptions()},save:function(){var e,t=bridge.info.options,a={};for(e in t){var n=$("#opt"+e),s=t[e],o=!1;null!=s&&"false"!=s||(s=!1),0!=n.length&&(n.is(":checkbox")?o=n.prop("checked"):n.is("select[multiple]")?null===(o=n.val())&&(o="*"):o=n.val(),s!=o&&s.toString()!==o.toString()&&(a[e]=o))}$.isEmptyObject(a)?console.log("options cache is empty"):(console.log("calling bridge.userAction.optionsChanged"),bridge.userAction({optionsChanged:a}),optionsPage.update(),a.hasOwnProperty("AutoRingSize")&&changeTxnType())}},RawTransactions=[],Transactions=[],filteredTransactions=[],current_key="",chainDataPage={anonOutputs:{},connectSignals:function(){console.log("chainDataPage.connectSignals"),bridge.listAnonOutputsResult.connect(this.listAnonOutputsResult)},init:function(){$("#show-own-outputs,#show-all-outputs").on("click",function(e){$(e.target).hide().siblings("a").show()}),$("#show-own-outputs").on("click",function(){$("#chaindata .footable tbody tr>td:first-child+td").each(function(){0==$(this).text()&&$(this).parents("tr").hide()})}),$("#show-all-outputs").on("click",function(){$("#chaindata .footable tbody tr:hidden").show()})},updateAnonOutputs:function(){bridge.listAnonOutputs()},listAnonOutputsResult:function(e){chainDataPage.anonOutputs=e;var t=$("#chaindata .footable tbody");for(value in t.html(""),chainDataPage.anonOutputs){var a=chainDataPage.anonOutputs[value];t.append("<tr>                    <td data-value="+value+">"+a.value_s+"</td>                    <td>"+a.owned_outputs+(a.owned_outputs==a.owned_mature?"":" (<b>"+(a.owned_outputs-a.owned_mature)+"</b>)")+"</td>                    <td>"+a.system_unspent+(a.system_unspent==a.system_unspent_mature?"":" (<b>"+(a.system_unspent-a.system_unspent_mature)+"</b>)")+"</td>                    <td>"+a.system_mixins+(a.system_mixins==a.system_mixins_mature?"":" (<b>"+(a.system_mixins-a.system_mixins_mature)+"</b>)")+"</td>                    <td>"+a.system_outputs+(0==a.system_compromised?"":" (<b>"+a.system_compromised+"</b>)")+"</td>                    <td>"+a.least_depth+"</td>                </tr>")}$("#chaindata .footable").trigger("footable_initialize")}},blockExplorerPage={blockHeader:{},connectSignals:function(){console.log("blockExplorerPage.connectSignals"),bridge.findBlockResult.connect(this.findBlockResult),bridge.listLatestBlocksResult.connect(this.listLatestBlocksResult),bridge.listTransactionsForBlockResult.connect(this.listTransactionsForBlockResult),bridge.txnDetailsResult.connect(this.txnDetailsResult),bridge.blockDetailsResult.connect(this.blockDetailsResult)},findBlock:function(e){console.log("findBlock : function(value)"),console.log(e),""===e||null===e?blockExplorerPage.updateLatestBlocks():bridge.findBlock(e)},findBlockResult:function(e){if(console.log("findBlockResult : function(result)"),blockExplorerPage.foundBlock=e,blockExplorerPage.foundBlock,""!==blockExplorerPage.foundBlock.error_msg)return $("#latest-blocks-table  > tbody").html(""),$("#block-txs-table > tbody").html(""),$("#block-txs-table").addClass("none"),alert(blockExplorerPage.foundBlock.error_msg),!1;var t=$("#latest-blocks-table  > tbody");t.html(""),$("#block-txs-table  > tbody").html(""),$("#block-txs-table").addClass("none"),t.append("<tr data-value="+blockExplorerPage.foundBlock.block_hash+">                                     <td>"+blockExplorerPage.foundBlock.block_hash+"</td>                                     <td>"+blockExplorerPage.foundBlock.block_height+"</td>                                     <td>"+blockExplorerPage.foundBlock.block_timestamp+"</td>                                     <td>"+blockExplorerPage.foundBlock.block_transactions+"</td>                        </tr>"),blockExplorerPage.prepareBlockTable()},updateLatestBlocks:function(){blockExplorerPage.latestBlocks=bridge.listLatestBlocks()},listLatestBlocksResult:function(e){console.log("function listLatestBlocksResult"),console.log(e),blockExplorerPage.latestBlocks=e,$("#block-txs-table  > tbody").html(""),$("#block-txs-table").addClass("none");var t=$("#latest-blocks-table  > tbody");for(value in t.html(""),blockExplorerPage.latestBlocks){var a=blockExplorerPage.latestBlocks[value];t.append("<tr data-value="+a.block_hash+">                         <td>"+a.block_hash+"</td>                         <td>"+a.block_height+"</td>                         <td>"+a.block_timestamp+"</td>                         <td>"+a.block_transactions+"</td>                         </tr>")}blockExplorerPage.prepareBlockTable()},prepareBlockTable:function(){$("#latest-blocks-table  > tbody tr").selection().on("click",function(){var e=$(this).attr("data-value").trim();blockExplorerPage.blkTxns=bridge.listTransactionsForBlock(e)}).on("dblclick",function(e){$("#block-info-modal").appendTo("body").modal("show"),selectedBlock=bridge.blockDetails($(this).attr("data-value").trim())}).find(".editable")},listTransactionsForBlockResult:function(e,t){blockExplorerPage.blkTxns=t;var a=$("#block-txs-table  > tbody");for(value in a.html(""),blockExplorerPage.blkTxns){var n=blockExplorerPage.blkTxns[value];a.append("<tr data-value="+n.transaction_hash+">                                    <td>"+n.transaction_hash+"</td>                                    <td>"+n.transaction_value+"</td>                                    </tr>")}$("#block-txs-table").removeClass("none"),$("#block-txs-table > tbody tr").selection().on("dblclick",function(t){$("#blkexp-txn-modal").appendTo("body").modal("show"),selectedTxn=bridge.txnDetails(e,$(this).attr("data-value").trim())}).find(".editable")},txnDetailsResult:function(e){selectedTxn=e,""==selectedTxn.error_msg&&($("#txn-hash").html(selectedTxn.transaction_hash),$("#txn-size").html(selectedTxn.transaction_size),$("#txn-rcvtime").html(selectedTxn.transaction_rcv_time),$("#txn-minetime").html(selectedTxn.transaction_mined_time),$("#txn-blkhash").html(selectedTxn.transaction_block_hash),$("#txn-reward").html(selectedTxn.transaction_reward),$("#txn-confirmations").html(selectedTxn.transaction_confirmations),$("#txn-value").html(selectedTxn.transaction_value),$("#error-msg").html(selectedTxn.error_msg),selectedTxn.transaction_reward>0?($("#lbl-reward-or-fee").html("<strong>Reward</strong>"),$("#txn-reward").html(selectedTxn.transaction_reward)):($("#lbl-reward-or-fee").html("<strong>Fee</strong>"),$("#txn-reward").html(-1*selectedTxn.transaction_reward)));var t=$("#txn-detail-inputs > tbody");for(value in t.html(""),selectedTxn.transaction_inputs){var a=selectedTxn.transaction_inputs[value];t.append("<tr data-value="+a.input_source_address+">                                                   <td>"+a.input_source_address+"</td>                                                   <td style='text-align:right'>"+a.input_value+"</td>                                                </tr>")}var n=$("#txn-detail-outputs > tbody");for(value in n.html(""),selectedTxn.transaction_outputs){var s=selectedTxn.transaction_outputs[value];n.append("<tr data-value="+s.output_source_address+">                                                 <td>"+s.output_source_address+"</td>                                                 <td style='text-align:right'>"+s.output_value+"</td>                                            </tr>")}},blockDetailsResult:function(e){selectedBlock=e,selectedBlock&&($("#blk-hash").html(selectedBlock.block_hash),$("#blk-numtx").html(selectedBlock.block_transactions),$("#blk-height").html(selectedBlock.block_height),$("#blk-type").html(selectedBlock.block_type),$("#blk-reward").html(selectedBlock.block_reward),$("#blk-timestamp").html(selectedBlock.block_timestamp),$("#blk-merkleroot").html(selectedBlock.block_merkle_root),$("#blk-prevblock").html(selectedBlock.block_prev_block),$("#blk-nextblock").html(selectedBlock.block_next_block),$("#blk-difficulty").html(selectedBlock.block_difficulty),$("#blk-bits").html(selectedBlock.block_bits),$("#blk-size").html(selectedBlock.block_size),$("#blk-version").html(selectedBlock.block_version),$("#blk-nonce").html(selectedBlock.block_nonce)),$(this).click().off("click").selection()}},walletManagementPage={connectSignals:function(){console.log("walletManagementPage.connectSignals"),bridge.importFromMnemonicResult.connect(this.importFromMnemonicResult),bridge.getNewMnemonicResult.connect(this.getNewMnemonicResult),bridge.extKeyAccListResult.connect(this.extKeyAccListResult),bridge.extKeyListResult.connect(this.extKeyListResult),bridge.extKeySetDefaultResult.connect(this.extKeySetDefaultResult),bridge.extKeySetMasterResult.connect(this.extKeySetMasterResult),bridge.extKeySetActiveResult.connect(this.extKeySetActiveResult)},init:function(){setupWizard("new-key-wizard"),setupWizard("recover-key-wizard"),setupWizard("open-key-wizard")},newMnemonic:function(){bridge.getNewMnemonic($("#new-account-passphrase").val(),$("#new-account-language").val())},getNewMnemonicResult:function(e){var t=e,a=t.error_msg,n=t.mnemonic;""!==a?alert(a):$("#new-key-mnemonic").val(n)},compareMnemonics:function(){return $("#new-key-mnemonic").val().trim()==$("#validate-key-mnemonic").val().trim()?($("#validate-key-mnemonic").removeClass("red"),$("#validate-key-mnemonic").val(""),!0):($("#validate-key-mnemonic").addClass("red"),alert("The recovery phrase you provided does not match the recovery phrase that was generated earlier - please go back and check to make sure you have copied it down correctly."),!1)},gotoPage:function(e){$("#navitems a[href='#"+e+"']").trigger("click")},prepareAccountTable:function(){$("#extkey-account-table  > tbody tr").selection().on("click",function(){$("#extkey-table > tbody > tr").removeClass("selected")})},updateAccountList:function(){bridge.extKeyAccList()},extKeyAccListResult:function(e){walletManagementPage.accountList=e;var t=$("#extkey-account-table  > tbody");for(value in t.html(""),walletManagementPage.accountList){e=walletManagementPage.accountList[value];t.append("<tr data-value="+e.id+" active-flag="+e.active+">                         <td>"+e.id+"</td>                         <td>"+e.label+"</td>                         <td>"+e.created_at+'</td>                         <td class="center-margin"><i style="font-size: 1.2em; margin: auto;" '+("true"==e.active?'class="fa fa-circle green-circle"':'class="fa fa-circle red-circle"')+' ></i></td>                         <td style="font-size: 1em; margin-bottom: 6px;">'+(void 0!==e.default_account?"<i class='center fa fa-check'></i>":"")+"</td>                         </tr>")}walletManagementPage.prepareAccountTable()},prepareKeyTable:function(){$("#extkey-table  > tbody tr").selection().on("click",function(){$("#extkey-account-table > tbody > tr").removeClass("selected")})},updateKeyList:function(){bridge.extKeyList()},extKeyListResult:function(e){walletManagementPage.keyList=e;var t=$("#extkey-table  > tbody");for(value in t.html(""),walletManagementPage.keyList){var a=walletManagementPage.keyList[value];t.append("<tr data-value="+a.id+" active-flag="+a.active+">                         <td>"+a.id+"</td>                         <td>"+a.label+"</td>                         <td>"+a.path+'</td>                         <td><i style="font-size: 1.2em; margin: auto;" '+("true"==a.active?'class="fa fa-circle green-circle"':'class="fa fa-circle red-circle"')+' ></i></td>                         <td style="font-size: 1em; margin-bottom: 6px;">'+(void 0!==a.current_master?"<i class='center fa fa-check'></i>":"")+"</td>                         </tr>")}walletManagementPage.prepareKeyTable()},newKey:function(){bridge.importFromMnemonic($("#new-key-mnemonic").val().trim(),$("#new-account-passphrase").val().trim(),$("#new-account-label").val().trim(),$("#new-account-bip44").prop("checked"),0)},importFromMnemonicResult:function(e){if(""!==e.error_msg)return alert(e.error_msg),!1},recoverKey:function(){bridge.importFromMnemonic($("#recover-key-mnemonic").val().trim(),$("#recover-passphrase").val().trim(),$("#recover-account-label").val().trim(),$("#recover-bip44").prop("checked"),1443657600)},setMaster:function(){return $("#extkey-table tr.selected").length?(selected=$("#extkey-table tr.selected").attr("data-value").trim(),void 0===selected||""===selected?(alert("Select a key from the table to set a Master."),!1):(result=bridge.extKeySetMaster(selected),""!==result.error_msg?(alert(result.error_msg),!1):void walletManagementPage.updateKeyList())):(alert("Please select a key to set it as master."),!1)},extKeySetMasterResult:function(e){},setDefault:function(){return $("#extkey-account-table tr.selected").length?(selected=$("#extkey-account-table tr.selected").attr("data-value").trim(),void 0===selected||""===selected?(alert("Select an account from the table to set a default."),!1):(result=bridge.extKeySetDefault(selected),""!==result.error_msg?(alert(result.error_msg),!1):void walletManagementPage.updateAccountList())):(alert("Please select an account to set it as default."),!1)},extKeySetDefaultResult:function(e){},changeActiveFlag:function(){var e=!1,t=$("#extkey-account-table tr.selected"),a=$("#extkey-table tr.selected");return t.length||a.length?(t.length?(selected=t.attr("data-value").trim(),active=t.attr("active-flag").trim(),e=!0):(selected=a.attr("data-value").trim(),active=a.attr("active-flag").trim()),void 0===selected||""===selected?(alert("Please select an account or key to change the active status."),!1):(result=bridge.extKeySetActive(selected,active),""!==result.error_msg?(alert(result.error_msg),!1):void(e?walletManagementPage.updateAccountList():walletManagementPage.updateKeyList()))):(alert("Please select an account or key to change the active status."),!1)},extKeySetActiveResult:function(e){}};function resizeTableBodies(){var e=$(window).height()-$("#transactions-table > tbody").offset().top-$("#transactions-table > tfoot").height()-21;$("#transactions-table > tbody").height(e);var t=$(window).height()-$("#chaindata-table > tbody").offset().top-$("#transactions-table > tfoot").height()-21;$("#chaindata-table > tbody").height(t)}window.onload=function(){overviewPage.init(),receivePageInit(),transactionPageInit(),addressBookInit(),chainDataPage.init(),walletManagementPage.init(),$(".footable,.footable-lookup").footable({breakpoints:{phone:480,tablet:700},delay:50}).on({footable_breakpoint:function(){},footable_row_expanded:function(e){$(this).find(".editable").off("dblclick").on("dblclick",function(e){e.stopPropagation(),updateValue($(this))}).attr("data-title","Double click to edit").tooltip()}}),$(".editable").on("dblclick",function(e){e.stopPropagation(),updateValue($(this))}).attr("data-title","Double click to edit %column%"),window.onresize=function(e){window.innerWidth>breakpoint&&$("#layout").removeClass("active"),resizeTableBodies()},bridge&&$("[href='#about']").on("click",function(){bridge.userAction(["aboutClicked"])}),$(".footable > tbody tr").selection(),connectSignals(),resizeTableBodies()},$.fn.selection=function(e){return e||(e="tr"),this.on("click",function(){$(this).addClass("selected").siblings(e).removeClass("selected")})};
